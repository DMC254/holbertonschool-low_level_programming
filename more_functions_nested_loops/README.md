This is for more functions and more nested loops
